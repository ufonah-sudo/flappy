/* ==========================================================================
   base.css - ГЛОБАЛЬНЫЕ СТИЛИ, НАВИГАЦИЯ И ИНТЕРФЕЙС (FIXED & POLISHED)
   ========================================================================== */

/* --- 1. ГЛОБАЛЬНЫЕ СБРОСЫ И МОБИЛЬНАЯ ОПТИМИЗАЦИЯ --- */
* {
    box-sizing: border-box; /* Учитываем отступы и границы в размере элемента */
    -webkit-tap-highlight-color: transparent !important; /* Убираем синюю подсветку при клике на мобильных */
    -webkit-touch-callout: none; /* Отключаем меню при долгом нажатии (iOS) */
    user-select: none; /* Запрещаем выделение текста пользователем */
    outline: none; /* Убираем обводку браузера при фокусе */
}

/* В твоем файле base.css замени блок body, html на этот: */

body, html {
    margin: 0; 
    padding: 0; 
    width: 100%; 
    height: 100%; /* Гарантирует растяжение */
    position: fixed; /* Гвоздями прибиваем к экрану, чтобы не скроллилось */
    overflow: hidden; /* Обрезаем всё лишнее */
    background: #4ec0ca url('/frontend/assets/fon.png') no-repeat center center;
    background-size: cover; 
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    color: white; 
    touch-action: none; /* Отключаем жесты браузера */
    -webkit-user-select: none; /* Запрет выделения на iOS */
    user-select: none;
    -webkit-text-size-adjust: 100%; /* Запрет авто-увеличения шрифта при повороте */
}
/* --- 2. СЛОИ (LAYERS) И КАНВАС --- */

/* Контейнер для облаков (Слой 1 - ФОН) */
.sky-container {
    position: absolute; /* Абсолютное позиционирование поверх body */
    top: 0; /* От самого верха */
    left: 0; /* От самого левого края */
    width: 100%; /* На всю ширину экрана */
    height: 100%; /* На всю высоту экрана */
    z-index: 1; /* Слой 1: Находится ПОД игрой, но поверх фона */
    pointer-events: none; /* Пропускает клики сквозь себя на игру */
    overflow: hidden; /* Обрезает облака, вылетающие за пределы экрана */
}

/* Общий стиль для всех облаков */
.cloud {
    position: absolute; /* Позиционируем каждое облако вручную координатами */
    opacity: 0.8; /* Легкая прозрачность для красоты */
    width: 90px; /* Фиксированная ширина (оптимально для мобильных) */
    height: auto; /* Высота подстраивается пропорционально ширине */
    will-change: transform; /* Сообщаем браузеру, что элемент будет двигаться (оптимизация) */
    /* Анимация: имя, длительность, линейность, бесконечность */
    animation: floatClouds 25s linear infinite; 
}

/* Ключевые кадры для анимации движения облаков */
@keyframes floatClouds {
    0% { transform: translateX(-150px); } /* Начало: за левым краем экрана */
    100% { transform: translateX(120vw); } /* Конец: за правым краем экрана */
}

/* Индивидуальные настройки для каждого из 6 облаков (разная скорость и позиция) */
.cloud1 { top: 10%; animation-duration: 35s; animation-delay: 0s; }   /* Облако 1: Медленное, сразу */
.cloud2 { top: 20%; animation-duration: 45s; animation-delay: -15s; } /* Облако 2: Очень медленное, начало с середины */
.cloud3 { top: 35%; animation-duration: 30s; animation-delay: -5s; }  /* Облако 3: Среднее */
.cloud4 { top: 50%; animation-duration: 40s; animation-delay: -25s; } /* Облако 4: Медленное */
.cloud5 { top: 65%; animation-duration: 32s; animation-delay: -10s; } /* Облако 5: Среднее */
.cloud6 { bottom: 15%; animation-duration: 38s; animation-delay: -2s; } /* Облако 6: Медленное, внизу */

/* Игровой холст (Слой 2 - ИГРА) */
canvas {
    position: absolute; /* Абсолютное позиционирование */
    top: 0; /* От верха */
    left: 0; /* От левого края */
    display: block; /* Убираем отступы строчных элементов */
    z-index: 10; /* Слой 10: ПОВЕРХ облаков, но ПОД интерфейсом */
}

/* Контейнер UI (Слой 3 - ИНТЕРФЕЙС) */
#app {
    position: relative; /* Относительное позиционирование для вложенных элементов */
    width: 100%; /* На всю ширину */
    height: 100%; /* На всю высоту */
    display: flex; /* Используем Flexbox для верстки */
    flex-direction: column; /* Элементы располагаются вертикально */
    z-index: 20; /* Слой 20: Поверх canvas */
    pointer-events: none; /* Важно: клики проходят сквозь пустые места контейнера */
}

/* --- 3. UI КНОПКИ (ТОП, ДЕЙЛИ, ПАУЗА) --- */

/* Общий класс для угловых кнопок */
.ui-corner-btn {
    position: absolute; /* Фиксируем кнопки в углах экрана */
    width: 50px;       /* Ширина кликабельной зоны */
    height: 50px;      /* Высота кликабельной зоны */
    z-index: 2000;     /* Слой 2000: Поверх всего интерфейса (ФИКС КЛИКАБЕЛЬНОСТИ) */
    cursor: pointer;   /* Курсор в виде руки */
    background: transparent !important; /* Прозрачный фон (ФИКС ФОНА) */
    border: none !important;            /* Убираем любые рамки */
    padding: 0;                         /* Убираем внутренние отступы */
    pointer-events: auto; /* Разрешаем клики по кнопке */
    display: block; /* Убеждаемся, что элемент блочный */
}

/* Стили картинки внутри кнопки */
.ui-corner-btn img {
    width: 100%;       /* Картинка на всю ширину кнопки */
    height: 100%;      /* Картинка на всю высоту кнопки */
    object-fit: contain; /* Сохраняем пропорции картинки */
    display: block;    /* Убираем отступы картинки */
}

/* Позиция кнопки ТОП (Слева вверху) */
#top-btn { 
    top: 20px; /* Отступ сверху */
    left: 20px; /* Отступ слева */
}

/* Позиция кнопки ДЕЙЛИ (Справа вверху) */
#daily-btn {
    top: 20px; /* Отступ сверху */
    right: 20px; /* Отступ справа */
}

/* Кнопка ПАУЗЫ (Справа вверху в игре) */
#pause-btn {
    position: absolute; /* Абсолютное позиционирование */
    top: 20px; /* Отступ сверху */
    right: 20px; /* Отступ справа (на месте дейли) */
    z-index: 2100; /* Выше чем обычные кнопки, чтобы нажималась в игре */
    cursor: pointer; /* Курсор-рука */
    pointer-events: auto; /* Разрешаем клик */
    background: transparent; /* Без фона */
    border: none; /* Без рамки */
    display: none; /* Скрыта по умолчанию (показывается JS) */
}

/* --- 4. ВЕРХНЯЯ ПАНЕЛЬ (БАЛАНСЫ) --- */
#header {
    position: fixed; /* Фиксируем панель при скролле */
    top: env(safe-area-inset-top, 15px); /* Учитываем "челку" iPhone или ставим 15px */
    width: 100%; /* На всю ширину */
    display: flex; /* Flexbox */
    justify-content: center; /* Центрируем содержимое по горизонтали */
    z-index: 1000; /* Слой 1000: Поверх игры */
    pointer-events: none; /* Сам контейнер пропускает клики */
}

.header-balances {
    display: flex; /* Элементы в ряд */
    gap: 15px; /* Расстояние между монетами и кристаллами */
    background: rgba(0, 0, 0, 0.65); /* Темный полупрозрачный фон */
    padding: 8px 22px; /* Внутренние отступы плашки */
    border-radius: 30px; /* Закругленные края */
    backdrop-filter: blur(12px); /* Эффект размытия фона (glassmorphism) */
    -webkit-backdrop-filter: blur(12px); /* Размытие для Safari */
    border: 1.5px solid rgba(255, 255, 255, 0.15); /* Тонкая светлая обводка */
    pointer-events: auto; /* Плашка ловит клики (если нужно) */
    box-shadow: 0 4px 15px rgba(0,0,0,0.4); /* Тень под плашкой */
}

.balance-item {
    color: #f7d51d; /* Золотой цвет цифр */
    font-weight: 800; /* Жирный шрифт */
    font-size: 18px; /* Размер шрифта */
    display: flex; /* Flexbox */
    align-items: center; /* Выравнивание по центру вертикально */
    gap: 6px; /* Расстояние между иконкой и цифрой */
    text-shadow: 0 2px 4px rgba(0,0,0,0.5); /* Тень текста */
}

.balance-item img {
    width: 20px; /* Ширина иконки */
    height: 20px; /* Высота иконки */
}

/* --- 5. НИЖНЯЯ ПАНЕЛЬ НАВИГАЦИИ --- */
.menu-buttons-panel {
    position: fixed !important; /* Жестко фиксируем внизу */
    bottom: 0 !important; /* Прижимаем к самому низу */
    padding-bottom: env(safe-area-inset-bottom, 15px) !important; /* Отступ для полоски iOS */
    left: 50% !important; /* Центрируем по левому краю */
    transform: translateX(-50%) !important; /* Сдвигаем на 50% влево для точного центра */
    width: 100% !important; /* Ширина на весь экран */
    max-width: 500px !important; /* Не шире 500px на планшетах */
    height: calc(85px + env(safe-area-inset-bottom, 0px)) !important; /* Высота панели */
    display: flex; /* Flexbox для кнопок */
    justify-content: space-around; /* Равномерное распределение кнопок */
    align-items: center; /* Центровка кнопок по вертикали */
    background: linear-gradient(to top, rgba(0,0,0,0.6), transparent) !important; /* Градиент фона */
    z-index: 3000 !important; /* Слой 3000: Поверх всего (ФИКС ПРОПАЖИ КНОПОК) */
    pointer-events: auto !important; /* Обязательно разрешаем клики */
}

.nav-btn {
    background: transparent; /* Прозрачный фон кнопки */
    border: none; /* Без границ */
    width: 65px; /* Ширина области нажатия */
    height: 65px; /* Высота области нажатия */
    cursor: pointer; /* Курсор-рука */
    padding: 0; /* Убираем отступы */
    transition: transform 0.1s ease; /* Анимация нажатия */
}

.nav-btn:active {
    transform: scale(0.9); /* Уменьшение при нажатии */
}

.nav-btn img {
    width: 100%; /* Картинка на всю ширину */
    height: 100%; /* Картинка на всю высоту */
    object-fit: contain; /* Вписываем картинку */
}

#btn-home-panel {
    width: 90px; /* Центральная кнопка больше */
    height: 90px; /* Центральная кнопка больше */
    transform: translateY(-20px); /* Приподнимаем её над остальными */
}

/* --- 6. ВЫБОР РЕЖИМА (ГЛАВНОЕ МЕНЮ) --- */
.modes-container {
    display: flex; /* Flexbox */
    flex-direction: column; /* Кнопки друг под другом */
    gap: 20px; /* Расстояние между кнопками */
    width: 100%; /* Ширина контейнера */
    align-items: center; /* Центровка */
    margin-top: 80px; /* Отступ сверху */
    pointer-events: auto; /* Разрешаем клики */
}

.mode-card {
    width: 280px; /* Ширина кнопки режима */
    height: 85px; /* Высота кнопки режима */
    background-size: contain; /* Картинка вписывается */
    background-position: center; /* Картинка по центру */
    background-repeat: no-repeat; /* Не повторять */
    cursor: pointer; /* Курсор-рука */
    border: none !important; /* Без рамки */
    background-color: transparent !important; /* Прозрачный фон */
    box-shadow: none !important; /* Без тени */
    text-indent: -9999px; /* Скрываем текст */
}

/* Фоны для кнопок режимов */
#btn-mode-classic { background-image: url('/frontend/assets/classic.png'); }
#btn-mode-arcade { background-image: url('/frontend/assets/arcade.png'); }

.mode-card:active { 
    transform: scale(0.96); /* Анимация клика */
    filter: brightness(0.9); /* Затемнение при клике */
}

/* --- 7. ЭКРАНЫ И МОДАЛКИ --- */
.screen {
    position: absolute; /* Абсолютное позиционирование */
    top: 0; /* От верха */
    left: 0; /* От левого края */
    width: 100%; /* На всю ширину */
    height: 100%; /* На всю высоту */
    display: flex; /* Flexbox */
    flex-direction: column; /* Колонка */
    align-items: center; /* Центр по горизонтали */
    justify-content: center; /* Центр по вертикали */
    padding: 20px; /* Отступы внутри */
    z-index: 100; /* Слой экранов */
    pointer-events: auto; /* Экран перехватывает клики */
}

/* Специфичный стиль для Game Over (ФИКС КЛИКАБЕЛЬНОСТИ ПОСЛЕ СМЕРТИ) */
#game-over {
    z-index: 5000 !important; /* Самый высокий слой, выше всего */
    background: rgba(0, 0, 0, 0.85); /* Затемненный фон */
    pointer-events: auto !important; /* Разрешаем клики по кнопкам */
}

.modal-bg {
    background: rgba(0, 0, 0, 0.75); /* Полупрозрачный черный фон */
    backdrop-filter: blur(8px); /* Размытие заднего плана */
    -webkit-backdrop-filter: blur(8px); /* Размытие для Safari */
}



/* --- 9. КНОПКИ И ТИПОГРАФИКА (ОБЩИЕ) --- */
.primary-btn {
    background: #f7d51d; /* Желтый фон */
    color: #222; /* Темный текст */
    padding: 16px 30px; /* Отступы внутри */
    border-radius: 20px; /* Закругление */
    font-weight: 900; /* Жирный шрифт */
    font-size: 18px; /* Размер текста */
    border: none; /* Без рамки */
    width: 100%; /* Ширина на весь контейнер */
    max-width: 260px; /* Максимальная ширина */
    cursor: pointer; /* Курсор */
    text-transform: uppercase; /* Заглавные буквы */
    margin-bottom: 10px; /* Отступ снизу */
}

.primary-btn:active {
    transform: scale(0.98); /* Эффект нажатия */
}

.secondary-btn {
    background: rgba(255, 255, 255, 0.1); /* Прозрачный белый */
    color: white; /* Белый текст */
    padding: 12px 24px; /* Отступы */
    border-radius: 18px; /* Закругление */
    border: 1px solid rgba(255, 255, 255, 0.3); /* Рамка */
    cursor: pointer; /* Курсор */
    font-weight: 600; /* Полужирный */
    text-transform: uppercase; /* Заглавные */
}

/* Утилитарные классы */
.hidden { display: none !important; } /* Класс для скрытия элементов */
.blur-overlay { backdrop-filter: blur(5px); } /* Класс для блюра */


.streak-grid {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-bottom: 20px;
}
.daily-card {
    background: rgba(0,0,0,0.5);
    border: 1px solid #555;
    border-radius: 10px;
    padding: 10px;
    width: 65px;
    text-align: center;
}
.daily-card.current { border-color: #f7d51d; background: rgba(247, 213, 29, 0.1); }
.daily-card.claimed { opacity: 0.6; }
.primary-btn-mini {
    background: #f7d51d;
    border: none;
    border-radius: 5px;
    font-size: 10px;
    font-weight: 800;
    padding: 4px 8px;
}
.challenge-item {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 10px;
    margin-bottom: 8px;
    width: 280px;
}
.ch-progress-bar {
    height: 6px;
    background: #333;
    border-radius: 3px;
    margin: 8px 0;
    overflow: hidden;
}
.ch-fill { height: 100%; background: #f7d51d; transition: width 0.3s; }
.ch-info { display: flex; justify-content: space-between; font-size: 12px; }

/* Разрешаем клики по всем важным элементам интерфейса */
.ui-corner-btn, 
.nav-btn, 
.primary-btn, 
.secondary-btn, 
.mode-card, 
.powerup-slot {
    pointer-events: auto !important;
}